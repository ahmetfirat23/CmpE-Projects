import pandas as pd

# Assume your dataframe is named df
df = pd.read_csv("encoded_data.csv")

# Example lists of dates for each category
vacation_dates =  [
    "2024-01-13", "2024-01-14", "2024-01-15", "2024-01-16", "2024-01-17",
    "2024-01-18", "2024-01-19", "2024-01-20", "2024-01-21", "2024-01-22",
    "2024-01-23", "2024-01-24", "2024-01-25", "2024-01-26", "2024-01-27",
    "2024-01-28", "2024-01-29", "2024-01-30", "2024-01-31", "2024-02-01",
    "2024-02-02", "2024-02-03", "2024-02-04", "2024-02-05", "2024-02-06",
    "2024-02-07", "2024-02-08", "2024-02-09", "2024-02-10", "2024-02-11",
    "2024-09-01", "2024-09-02", "2024-09-03", "2024-09-04", "2024-09-05",
    "2024-09-06", "2024-09-07", "2024-09-08", "2024-09-09", "2024-09-10",
    "2024-09-11", "2024-09-12", "2024-09-13", "2024-09-14", "2024-09-15",
    "2024-09-16", "2024-09-17", "2024-09-18", "2024-09-19", "2024-09-20",
    "2024-09-21", "2024-09-22"
]

public_holiday_dates = [
    "2024-01-01", "2024-04-23", "2024-05-01", "2024-05-19", 
    "2024-07-15", "2024-08-30", "2024-10-29", "2024-05-27", "2024-07-24"
]
eid_dates = [
    "2024-04-09", "2024-04-10", "2024-04-11", "2024-04-12",
    "2024-06-15", "2024-06-16", "2024-06-17", "2024-06-18",
    "2024-06-19", "2024-06-20", "2024-06-21", "2024-06-22",
    "2024-06-23", "2024-06-24"
]
final_dates = [
    "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05", "2024-01-06",
    "2024-01-07", "2024-01-08", "2024-01-09", "2024-01-10", "2024-01-11",
    "2024-01-12", "2024-01-13", "2024-05-17", "2024-05-18", "2024-05-19",
    "2024-05-20", "2024-05-21", "2024-05-22", "2024-05-23", "2024-05-24",
    "2024-05-25", "2024-05-26", "2024-05-27", "2024-05-28", "2024-05-29",
    "2024-05-30", "2024-05-31", "2024-06-01", "2024-06-02", "2024-06-03",
    "2024-06-04", "2024-06-05", "2024-06-06", "2024-06-07", "2024-06-08"
]
# Function to determine status
def get_status(date, day_of_week):
    if date in vacation_dates:
        return 0  # Vacation
    elif date in eid_dates:
        return 1  # Eid
    elif date in public_holiday_dates:
        return 2  # Public Holiday
    elif date in final_dates:
        return 3  # Final Dates
    elif day_of_week in ['saturday', 'sunday']:
        return 4  # Weekend
    else:
        return 5  # Classes

# Apply the function to each row in the dataframe to create the 'status' column
df['status'] = df.apply(lambda row: get_status(row['date'], row['day']), axis=1)

# Save the dataframe or display the result
df.to_csv('dataset_with_status.csv', index=False)
print(df.head())  # Display the first few rows to verify
